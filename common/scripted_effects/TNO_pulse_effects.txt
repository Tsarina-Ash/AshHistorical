first_every_week_script = {
	ZZZ = {
		update_market = yes
	}

	# Allow suppressed TNO alerts to reappear
	every_country = {
		if = {
			limit = { is_ai = no }
			TNO_alert_suppression_weekly_tick = yes
		}
	}
}

first_every_month_script = {
	log = "[GetDateText]: [Root.GetName]: first_every_month_script"
	add_to_variable = { month_counter = 1 }
	if = {
		limit = {
			check_variable = {
				month_counter = 13
			}
		}
		set_variable = { month_counter = 1 }
		first_every_year_script = yes
	}
	#add_manpower = -100 #Why? -Pacifica #I think its to keep Anarchy Island on 0 Recruit manpower IG - OPAsian

	ZZZ =  {
		add_to_variable = { econ_graph_month = 1 }
	}

	every_country = {
		set_variable = { total_pop_m = 0 }
		set_variable = { total_core_pop_m = 0 }
		every_owned_state = {
			set_temp_variable = { spm = state_population_k }
			divide_temp_variable = { spm = 1000 }
			add_to_variable = { PREV.total_pop_m = spm }
			if = {
				limit = { is_core_of = THIS }
				add_to_variable = { PREV.total_core_pop_m = spm }
			}
		}
		set_variable = { total_ncore_pop_m = total_pop_m }
		subtract_from_variable = { total_ncore_pop_m = total_core_pop_m }
	}

	every_country = {
		if = {
			limit = {
				any_neighbor_country = {
					OR = {
						check_variable = { THIS.num_divisions > THIS.TNOLimiterIndustry }
						check_variable = { THIS.TNOLimiterIndustry > ROOT.TNOLimiterIndustry }
					}
				}
			}
			TNO_div_limiter_escalator_mechanism_run = yes
		}
		TNO_div_limiter_calculate_unit_cap = yes
	}

	#if = {
	#	limit = {
	#		KOK = {
	#			exists = yes
	#		}
	#	}
	#	KOK = {
	#		#khanate_legitimacy_overflow_check = yes
	#		khanate_legitimacy_idea_assignment = yes
	#
	#		if = {
	#			limit = {
	#				NOT = { has_country_flag = KOK_FAIR_KHAN }
	#			}
	#			khanate_monthly_unrest_calc = yes
	#			khanate_vibe_check = yes
	#			khanate_slave_bonus_scaling = yes
	#			khanate_monthly_slave_gain = yes
	#		}
	#		if = {
	#			limit = {
	#				check_variable = { khanate_slave_unrest_monthly > 0.01 }
	#			}
	#			khanate_unrest_increase = yes
	#		}
	#	}
	#}

	ZZZ = {
		econ_recompile_all_spheres = yes
		generate_econ_rankings = yes
		econ_get_world_gdp = yes
	}

	ZZZ_econ_inflation_cycling_calculation = yes 

	clear_array = GLOBAL.econ_sphere_leaders # necessary for some calcs :) 
	
	every_country = {
		if = {
			limit = {
				econ_can_use_economy_system = yes
			}
			if = {
				limit = { NOT = { has_idea = economy_multiplicative_modifiers_base } }
				add_ideas = economy_multiplicative_modifiers_base
			}
			societal_development_monthly_check = yes # update policy effectiveness first! 
			econ_calculations_ON_MONTHLY = yes
			calculate_consumer_goods_need = yes #Do this after consumption so the base value won't suddenly change on the player
		}
	}

	every_country = {
		limit = {
			check_variable = { GDP = 0.0 } #already converted to billion
		}
		generate_country_gdp = yes
	}

	USA = {
		USA_monthly_pulse_effect = yes
	}

	#if = {
		#	limit = {
			#		NPL = {
				#			exists = yes
				#			NOT = {
					#				has_country_flag = NPL_revolt
					#			}
				#		}
			#	}
		#	NPL = {
			#		add_to_variable = { NPL_Polish_Approval = NPL_Polish_Approval_monthly }
			#		add_to_variable = { NPL_Native_Unrest = NPL_Native_Unrest_monthly }
			#		add_to_variable = { NPL_Food_Security = NPL_Food_Security_monthly }
			#		NPL_clamp_all_variables = yes
			#		NPL_check_all_variables = yes
			#	}
		#}

	# if = {
	# 	limit = {
	# 		OR = {
	# 			country_exists = FEN
	# 			country_exists = ENG
	# 		}
	# 	}
	# 	ParliamentMechanic_GovStab_Calculate = yes
	# }

	# ARC stuff
	update_state_population_custom_growth = yes 
}

#for when monthly_population is less than -1
properly_reduce_population = {
	every_controlled_state = {
		set_temp_variable = { manpower_to_remove_k = PREV.modifier@monthly_population }
		multiply_temp_variable = { manpower_to_remove_k = 100 } # lmao
		multiply_temp_variable = { manpower_to_remove_k = 0.015 } # actual pop growth rate expressed as % in 100
		multiply_temp_variable = { manpower_to_remove_k = state_population_k } # number to add in k x 100 
		multiply_temp_variable = { manpower_to_remove_k = 10 } 
		divide_temp_variable = { manpower_to_remove_k = 12 } # occurs monthly! 
		add_manpower = var:manpower_to_remove_k
		log = "Added [?manpower_to_remove_k] to [THIS.GETNAME] "
	}
}

societal_development_monthly_check = {
	#Keeping this around as a template

	# TNO_process_policy_effectiveness_monthly_tick = yes

	# add_to_variable = { admin_efficiency_counter = admin_efficiency_monthly_change }
	# add_to_variable = { admin_efficiency_counter = modifier@admin_efficiency_monthly_rate }
	# add_to_variable = { academic_base_counter = academic_base_monthly_change }
	# add_to_variable = { academic_base_counter = modifier@academic_base_monthly_rate }
	# add_to_variable = { agriculture_counter = agriculture_monthly_change }
	# add_to_variable = { agriculture_counter = modifier@agriculture_monthly_rate }
	# add_to_variable = { army_professionalism_counter = army_professionalism_monthly_change }
	# add_to_variable = { army_professionalism_counter = modifier@army_professionalism_monthly_rate }
	# add_to_variable = { research_facilities_counter = research_facilities_monthly_change }
	# add_to_variable = { research_facilities_counter = modifier@research_facilities_monthly_rate }
	# add_to_variable = { industrial_expertise_counter = industrial_expertise_monthly_change }
	# add_to_variable = { industrial_expertise_counter = modifier@industrial_expertise_monthly_rate }
	# add_to_variable = { industrial_equipment_counter = industrial_equipment_monthly_change }
	# add_to_variable = { industrial_equipment_counter = modifier@industrial_equipment_monthly_rate }

	# if = {
	# 	limit = { check_variable = { admin_efficiency_counter > 239 } }
	# 	country_event = societal_development.1102
	# 	add_to_variable = { admin_efficiency_counter = -240 }
	# 	multiply_variable = { admin_efficiency_monthly_change = 0.25 }
	# }
	# else_if = {
	# 	limit = { check_variable = { admin_efficiency_counter < -239 } }
	# 	country_event = societal_development.1103
	# 	add_to_variable = { admin_efficiency_counter = 240 }
	# 	multiply_variable = { admin_efficiency_monthly_change = 0.25 }
	# }

	# if = {
	# 	limit = { check_variable = { academic_base_counter > 239 } }
	# 	country_event = societal_development.1104
	# 	add_to_variable = { academic_base_counter = -240 }
	# 	multiply_variable = { academic_base_monthly_change = 0.25 }
	# }
	# else_if = {
	# 	limit = { check_variable = { academic_base_counter < -239 } }
	# 	country_event = societal_development.1105
	# 	add_to_variable = { academic_base_counter = 240 }
	# 	multiply_variable = { academic_base_monthly_change = 0.25 }
	# }

	# if = {
	# 	limit = { check_variable = { research_facilities_counter > 239 } }
	# 	country_event = societal_development.1106
	# 	add_to_variable = { research_facilities_counter = -240 }
	# 	multiply_variable = { research_facilities_monthly_change = 0.25 }
	# }
	# else_if = {
	# 	limit = { check_variable = { research_facilities_counter < -239 } }
	# 	country_event = societal_development.1107
	# 	add_to_variable = { research_facilities_counter = 240 }
	# 	multiply_variable = { research_facilities_monthly_change = 0.25 }
	# }

	# if = {
	# 	limit = { check_variable = { industrial_expertise_counter > 239 } }
	# 	country_event = societal_development.1110
	# 	add_to_variable = { industrial_expertise_counter = -240 }
	# 	multiply_variable = { industrial_expertise_monthly_change = 0.25 }
	# }
	# else_if = {
	# 	limit = { check_variable = { industrial_expertise_counter < -239 } }
	# 	country_event = societal_development.1111
	# 	add_to_variable = { industrial_expertise_counter = 240 }
	# 	multiply_variable = { industrial_expertise_monthly_change = 0.25 }
	# }

	# if = {
	# 	limit = { check_variable = { industrial_equipment_counter > 239 } }
	# 	country_event = societal_development.1112
	# 	add_to_variable = { industrial_equipment_counter = -240 }
	# 	multiply_variable = { industrial_equipment_monthly_change = 0.25 }
	# }
	# else_if = {
	# 	limit = { check_variable = { industrial_equipment_counter < -239 } }
	# 	country_event = societal_development.1113
	# 	add_to_variable = { industrial_equipment_counter = 240 }
	# 	multiply_variable = { industrial_equipment_monthly_change = 0.25 }
	# }

	# if = {
	# 	limit = { check_variable = { agriculture_counter > 239 } }
	# 	country_event = societal_development.1114
	# 	add_to_variable = { agriculture_counter = -240 }
	# 	multiply_variable = { agriculture_monthly_change = 0.25 }
	# }
	# else_if = {
	# 	limit = { check_variable = { agriculture_counter < -239 } }
	# 	country_event = societal_development.1115
	# 	add_to_variable = { agriculture_counter = 240 }
	# 	multiply_variable = { agriculture_monthly_change = 0.25 }
	# }

	# if = {
	# 	limit = { check_variable = { army_professionalism_counter > 239 } }
	# 	country_event = societal_development.1116
	# 	add_to_variable = { army_professionalism_counter = -240 }
	# 	multiply_variable = { army_professionalism_monthly_change = 0.25 }
	# }
	# else_if = {
	# 	limit = { check_variable = { army_professionalism_counter < -239 } }
	# 	country_event = societal_development.1117
	# 	add_to_variable = { army_professionalism_counter = 240 }
	# 	multiply_variable = { army_professionalism_monthly_change = 0.25 }
	# }
}
